{"ast":null,"code":"import axios from'axios';const API_BASE_URL='http://localhost:8001/api';const api=axios.create({baseURL:API_BASE_URL});api.interceptors.request.use(config=>{const token=localStorage.getItem('token');if(token){config.headers.Authorization=\"Bearer \".concat(token);}return config;},error=>{return Promise.reject(error);});// Grup API'leri - BUNLARIN TAMAMI groupAPI OBJESƒ∞ ƒ∞√áƒ∞NDE OLMALI\nexport const groupAPI={getGroups:()=>api.get('/groups/'),createGroup:name=>api.post('/groups/create/',{name,members:[{\"email\":\"\"}]}),joinGroup:groupId=>api.post(\"/groups/\".concat(groupId,\"/join/\")),leaveGroup:groupId=>api.post(\"/groups/\".concat(groupId,\"/leave/\")),getGroupFiles:groupId=>api.get(\"/groups/\".concat(groupId,\"/files/\")),checkGroupAuth:groupId=>api.get(\"/groups/\".concat(groupId,\"/check-auth/\")),sendInvites:(groupId,emails)=>{return api.post(\"/groups/\".concat(groupId,\"/invite/\"),{emails});},joinByInviteCode:inviteCode=>{return api.post('/groups/join-by-code/',{invite_code:inviteCode});},getGroupInvitations:groupId=>{return api.get(\"/groups/\".concat(groupId,\"/invitations/\"));}};// Dosya API'leri\nexport const fileAPI={uploadFile:(groupId,formData)=>{if(!groupId){return Promise.reject(new Error('Group ID tanƒ±mlƒ± deƒüil'));}return api.post(\"/groups/\".concat(groupId,\"/upload/\"),formData,{headers:{'Content-Type':'multipart/form-data'}});},downloadFile:fileId=>api.get(\"/files/\".concat(fileId,\"/download/\"),{responseType:'blob'}),getFileDetail:fileId=>api.get(\"/files/\".concat(fileId,\"/\")),getFileComments:fileId=>api.get(\"/files/\".concat(fileId,\"/comments/\")),addComment:(fileId,text)=>api.post(\"/files/\".concat(fileId,\"/comment/\"),{text}),getFileReport:fileId=>api.get(\"/files/\".concat(fileId,\"/report/\"))};// Auth API'leri\nexport const authAPI={login:(email,password)=>api.post('/auth/login/',{email,password}),checkAuth:()=>api.get('/users/me/'),refreshToken:()=>api.post('/auth/token/refresh/',{refresh:localStorage.getItem('refresh_token')})};// api.js - interceptor'ƒ± tamamen yenileyin\nlet isRefreshing=false;let failedQueue=[];const processQueue=function(error){let token=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;failedQueue.forEach(prom=>{if(error){prom.reject(error);}else{prom.resolve(token);}});failedQueue=[];};/* api.interceptors.response.use(\r\n    (response) => response,\r\n    async (error) => {\r\n        const originalRequest = error.config;\r\n\r\n        // Eƒüer 401 hatasƒ± deƒüilse veya zaten retry yapƒ±ldƒ±ysa\r\n        if (error.response?.status !== 401 || originalRequest._retry) {\r\n            return Promise.reject(error);\r\n        }\r\n\r\n        // Eƒüer zaten refresh yapƒ±lƒ±yorsa, request'i kuyruƒüa al\r\n        if (isRefreshing) {\r\n            return new Promise((resolve, reject) => {\r\n                failedQueue.push({ resolve, reject });\r\n            }).then(token => {\r\n                originalRequest.headers.Authorization = `Bearer ${token}`;\r\n                return api(originalRequest);\r\n            }).catch(err => {\r\n                return Promise.reject(err);\r\n            });\r\n        }\r\n\r\n        originalRequest._retry = true;\r\n        isRefreshing = true;\r\n\r\n        try {\r\n            const refreshToken = localStorage.getItem('refresh_token');\r\n            if (!refreshToken) {\r\n                throw new Error('No refresh token available');\r\n            }\r\n\r\n            console.log('üîÑ Token refresh ediliyor...');\r\n            const response = await api.post('/auth/token/refresh/', {\r\n                refresh: refreshToken\r\n            });\r\n\r\n            const newToken = response.data.access;\r\n            localStorage.setItem('access_token', newToken);\r\n\r\n            console.log('‚úÖ Yeni token alƒ±ndƒ±:', newToken);\r\n\r\n            // T√ºm kuyruktaki request'leri i≈üle\r\n            processQueue(null, newToken);\r\n            isRefreshing = false;\r\n\r\n            // Orijinal request'i yeni token ile tekrarla\r\n            originalRequest.headers.Authorization = `Bearer ${newToken}`;\r\n            return api(originalRequest);\r\n\r\n        } catch (refreshError) {\r\n            console.error('‚ùå Token refresh failed:', refreshError);\r\n\r\n            // Kuyruktaki t√ºm request'leri ba≈üarƒ±sƒ±z olarak i≈üaretle\r\n            processQueue(refreshError, null);\r\n            isRefreshing = false;\r\n\r\n            // Token'larƒ± temizle ve login sayfasƒ±na y√∂nlendir\r\n            localStorage.removeItem('access_token');\r\n            localStorage.removeItem('refresh_token');\r\n            localStorage.removeItem('user');\r\n\r\n            // Sadece bir kere y√∂nlendir\r\n            if (!window.location.pathname.includes('/login')) {\r\n                window.location.href = '/login';\r\n            }\r\n\r\n            return Promise.reject(refreshError);\r\n        }\r\n    }\r\n);\r\n*/export default api;","map":{"version":3,"names":["axios","API_BASE_URL","api","create","baseURL","interceptors","request","use","config","token","localStorage","getItem","headers","Authorization","concat","error","Promise","reject","groupAPI","getGroups","get","createGroup","name","post","members","joinGroup","groupId","leaveGroup","getGroupFiles","checkGroupAuth","sendInvites","emails","joinByInviteCode","inviteCode","invite_code","getGroupInvitations","fileAPI","uploadFile","formData","Error","downloadFile","fileId","responseType","getFileDetail","getFileComments","addComment","text","getFileReport","authAPI","login","email","password","checkAuth","refreshToken","refresh","isRefreshing","failedQueue","processQueue","arguments","length","undefined","forEach","prom","resolve"],"sources":["C:/Users/Burak/Desktop/cloud_mvp/frontend/src/utils/api.js"],"sourcesContent":["import axios from 'axios';\r\n\r\nconst API_BASE_URL = 'http://localhost:8001/api';\r\n\r\nconst api = axios.create({\r\n    baseURL: API_BASE_URL,\r\n});\r\n\r\napi.interceptors.request.use(\r\n    (config) => {\r\n        const token = localStorage.getItem('token');\r\n        if (token) {\r\n            config.headers.Authorization = `Bearer ${token}`;\r\n        }\r\n        return config;\r\n    },\r\n    (error) => {\r\n        return Promise.reject(error);\r\n    }\r\n);\r\n\r\n// Grup API'leri - BUNLARIN TAMAMI groupAPI OBJESƒ∞ ƒ∞√áƒ∞NDE OLMALI\r\nexport const groupAPI = {\r\n    getGroups: () => api.get('/groups/'),\r\n    createGroup: (name) => api.post('/groups/create/', { name, members: [{ \"email\": \"\" }] }),\r\n    joinGroup: (groupId) => api.post(`/groups/${groupId}/join/`),\r\n    leaveGroup: (groupId) => api.post(`/groups/${groupId}/leave/`),\r\n    getGroupFiles: (groupId) => api.get(`/groups/${groupId}/files/`),\r\n    checkGroupAuth: (groupId) => api.get(`/groups/${groupId}/check-auth/`),\r\n\r\n    sendInvites: (groupId, emails) => {\r\n        return api.post(`/groups/${groupId}/invite/`, { emails });\r\n    },\r\n\r\n    joinByInviteCode: (inviteCode) => {\r\n        return api.post('/groups/join-by-code/', { invite_code: inviteCode });\r\n    },\r\n\r\n    getGroupInvitations: (groupId) => {\r\n        return api.get(`/groups/${groupId}/invitations/`);\r\n    }\r\n};\r\n\r\n// Dosya API'leri\r\nexport const fileAPI = {\r\n    uploadFile: (groupId, formData) => {\r\n        if (!groupId) {\r\n            return Promise.reject(new Error('Group ID tanƒ±mlƒ± deƒüil'));\r\n        }\r\n        return api.post(`/groups/${groupId}/upload/`, formData, {\r\n            headers: { 'Content-Type': 'multipart/form-data' }\r\n        });\r\n    },\r\n    downloadFile: (fileId) => api.get(`/files/${fileId}/download/`, {\r\n        responseType: 'blob'\r\n    }),\r\n    getFileDetail: (fileId) => api.get(`/files/${fileId}/`),\r\n    getFileComments: (fileId) => api.get(`/files/${fileId}/comments/`),\r\n    addComment: (fileId, text) => api.post(`/files/${fileId}/comment/`, { text }),\r\n    getFileReport: (fileId) => api.get(`/files/${fileId}/report/`),\r\n};\r\n\r\n// Auth API'leri\r\nexport const authAPI = {\r\n    login: (email, password) =>\r\n        api.post('/auth/login/', { email, password }),\r\n\r\n    checkAuth: () =>\r\n        api.get('/users/me/'),\r\n\r\n    refreshToken: () =>\r\n        api.post('/auth/token/refresh/', {\r\n            refresh: localStorage.getItem('refresh_token')\r\n        }),\r\n};\r\n// api.js - interceptor'ƒ± tamamen yenileyin\r\nlet isRefreshing = false;\r\nlet failedQueue = [];\r\n\r\nconst processQueue = (error, token = null) => {\r\n    failedQueue.forEach(prom => {\r\n        if (error) {\r\n            prom.reject(error);\r\n        } else {\r\n            prom.resolve(token);\r\n        }\r\n    });\r\n    failedQueue = [];\r\n};\r\n\r\n/* api.interceptors.response.use(\r\n    (response) => response,\r\n    async (error) => {\r\n        const originalRequest = error.config;\r\n\r\n        // Eƒüer 401 hatasƒ± deƒüilse veya zaten retry yapƒ±ldƒ±ysa\r\n        if (error.response?.status !== 401 || originalRequest._retry) {\r\n            return Promise.reject(error);\r\n        }\r\n\r\n        // Eƒüer zaten refresh yapƒ±lƒ±yorsa, request'i kuyruƒüa al\r\n        if (isRefreshing) {\r\n            return new Promise((resolve, reject) => {\r\n                failedQueue.push({ resolve, reject });\r\n            }).then(token => {\r\n                originalRequest.headers.Authorization = `Bearer ${token}`;\r\n                return api(originalRequest);\r\n            }).catch(err => {\r\n                return Promise.reject(err);\r\n            });\r\n        }\r\n\r\n        originalRequest._retry = true;\r\n        isRefreshing = true;\r\n\r\n        try {\r\n            const refreshToken = localStorage.getItem('refresh_token');\r\n            if (!refreshToken) {\r\n                throw new Error('No refresh token available');\r\n            }\r\n\r\n            console.log('üîÑ Token refresh ediliyor...');\r\n            const response = await api.post('/auth/token/refresh/', {\r\n                refresh: refreshToken\r\n            });\r\n\r\n            const newToken = response.data.access;\r\n            localStorage.setItem('access_token', newToken);\r\n\r\n            console.log('‚úÖ Yeni token alƒ±ndƒ±:', newToken);\r\n\r\n            // T√ºm kuyruktaki request'leri i≈üle\r\n            processQueue(null, newToken);\r\n            isRefreshing = false;\r\n\r\n            // Orijinal request'i yeni token ile tekrarla\r\n            originalRequest.headers.Authorization = `Bearer ${newToken}`;\r\n            return api(originalRequest);\r\n\r\n        } catch (refreshError) {\r\n            console.error('‚ùå Token refresh failed:', refreshError);\r\n\r\n            // Kuyruktaki t√ºm request'leri ba≈üarƒ±sƒ±z olarak i≈üaretle\r\n            processQueue(refreshError, null);\r\n            isRefreshing = false;\r\n\r\n            // Token'larƒ± temizle ve login sayfasƒ±na y√∂nlendir\r\n            localStorage.removeItem('access_token');\r\n            localStorage.removeItem('refresh_token');\r\n            localStorage.removeItem('user');\r\n\r\n            // Sadece bir kere y√∂nlendir\r\n            if (!window.location.pathname.includes('/login')) {\r\n                window.location.href = '/login';\r\n            }\r\n\r\n            return Promise.reject(refreshError);\r\n        }\r\n    }\r\n);\r\n*/\r\nexport default api;\r\n"],"mappings":"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EzBiC,YAAY,CAAEA,CAAA,GACVnD,GAAG,CAACqB,IAAI,CAAC,sBAAsB,CAAE,CAC7B+B,OAAO,CAAE5C,YAAY,CAACC,OAAO,CAAC,eAAe,CACjD,CAAC,CACT,CAAC,CACD;AACA,GAAI,CAAA4C,YAAY,CAAG,KAAK,CACxB,GAAI,CAAAC,WAAW,CAAG,EAAE,CAEpB,KAAM,CAAAC,YAAY,CAAG,QAAAA,CAAC1C,KAAK,CAAmB,IAAjB,CAAAN,KAAK,CAAAiD,SAAA,CAAAC,MAAA,IAAAD,SAAA,MAAAE,SAAA,CAAAF,SAAA,IAAG,IAAI,CACrCF,WAAW,CAACK,OAAO,CAACC,IAAI,EAAI,CACxB,GAAI/C,KAAK,CAAE,CACP+C,IAAI,CAAC7C,MAAM,CAACF,KAAK,CAAC,CACtB,CAAC,IAAM,CACH+C,IAAI,CAACC,OAAO,CAACtD,KAAK,CAAC,CACvB,CACJ,CAAC,CAAC,CACF+C,WAAW,CAAG,EAAE,CACpB,CAAC,CAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EACA,cAAe,CAAAtD,GAAG","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}