{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Burak\\\\Desktop\\\\cloud_mvp\\\\frontend\\\\src\\\\components\\\\SecureFileViewer.jsx\",\n  _s = $RefreshSig$();\n// SecureFileViewer.jsx\nimport React, { useState, useEffect } from 'react';\nimport SecureViewer from './SecureViewer';\nimport { useParams } from 'react-router-dom';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst SecureFileViewer = () => {\n  _s();\n  var _fileData$user_email;\n  const [fileData, setFileData] = useState(null);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(null);\n  const {\n    token\n  } = useParams();\n  useEffect(() => {\n    const fetchFileData = async () => {\n      if (!token) {\n        setError(\"Geçersiz veya eksik token.\");\n        setLoading(false);\n        return;\n      }\n      try {\n        // API endpoint'ini güncelle\n        const response = await fetch(`http://localhost:8001/api/share/${token}/`);\n\n        /* if (response.headers.get('X-Security-Breach') === 'CAMERA_DETECTED') {\r\n            throw new Error('Kamera Güvenlik İhlali Tespit Edildi ve Engellendi.');\r\n        }\r\n        */\n\n        if (!response.ok) {\n          // Eğer backend 403 döndürdüyse JSON veya HTML olabilir\n          const contentType = response.headers.get(\"content-type\");\n          if (contentType && contentType.indexOf(\"application/json\") !== -1) {\n            const errorData = await response.json();\n            throw new Error(errorData.error || 'Erişim hatası');\n          } else {\n            throw new Error('Dosyaya erişilemiyor (Süre dolmuş veya güvenlik engeli).');\n          }\n        }\n        const data = await response.json();\n        setFileData(data);\n      } catch (err) {\n        setError(err.message);\n      } finally {\n        setLoading(false);\n      }\n    };\n    fetchFileData();\n  }, [token]);\n  if (loading) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        padding: '50px',\n        textAlign: 'center',\n        background: '#1a1a1a',\n        color: 'white',\n        borderRadius: '8px'\n      },\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        children: \"Dosya y\\xFCkleniyor...\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 60,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 53,\n      columnNumber: 13\n    }, this);\n  }\n  if (error) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        padding: '50px',\n        textAlign: 'center',\n        background: '#ff4444',\n        color: 'white',\n        borderRadius: '8px'\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n        children: \"Hata\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 74,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        children: error\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 75,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 67,\n      columnNumber: 13\n    }, this);\n  }\n  if (!fileData) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        padding: '50px',\n        textAlign: 'center',\n        background: '#ffaa00',\n        color: 'white',\n        borderRadius: '8px'\n      },\n      children: /*#__PURE__*/_jsxDEV(\"p\", {\n        children: \"Dosya bulunamad\\u0131\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 89,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 82,\n      columnNumber: 13\n    }, this);\n  }\n\n  // Eski SingleViewMedia component'ini kullanmak için:\n  // return (\n  //     <SingleViewMedia\n  //         secureMediaUrl={fileData.secure_media_url}\n  //         userEmail={fileData.user_email}\n  //         onConsumed={() => console.log('Content consumed')}\n  //     />\n  // );\n\n  // Yeni SecureViewer component'ini kullanmak için:\n  return /*#__PURE__*/_jsxDEV(SecureViewer, {\n    file: {\n      one_time_view: fileData.one_time_view,\n      file_name: fileData.file_name,\n      secure_media_url: fileData.secure_media_url\n    },\n    user: {\n      email: fileData.user_email,\n      username: ((_fileData$user_email = fileData.user_email) === null || _fileData$user_email === void 0 ? void 0 : _fileData$user_email.split('@')[0]) || 'Kullanıcı'\n    },\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        textAlign: 'center',\n        padding: '20px'\n      },\n      children: /*#__PURE__*/_jsxDEV(\"img\", {\n        src: fileData.secure_media_url,\n        alt: fileData.file_name,\n        style: {\n          maxWidth: '100%',\n          maxHeight: '80vh',\n          borderRadius: '8px'\n        },\n        onError: e => {\n          console.error('Resim yüklenemedi');\n          e.target.style.display = 'none';\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 117,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 116,\n      columnNumber: 13\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 105,\n    columnNumber: 9\n  }, this);\n};\n_s(SecureFileViewer, \"YpQ5AdyCzHNIY3Oh+1+l0uiOylQ=\", false, function () {\n  return [useParams];\n});\n_c = SecureFileViewer;\nexport default SecureFileViewer;\nvar _c;\n$RefreshReg$(_c, \"SecureFileViewer\");","map":{"version":3,"names":["React","useState","useEffect","SecureViewer","useParams","jsxDEV","_jsxDEV","SecureFileViewer","_s","_fileData$user_email","fileData","setFileData","loading","setLoading","error","setError","token","fetchFileData","response","fetch","ok","contentType","headers","get","indexOf","errorData","json","Error","data","err","message","style","padding","textAlign","background","color","borderRadius","children","fileName","_jsxFileName","lineNumber","columnNumber","file","one_time_view","file_name","secure_media_url","user","email","user_email","username","split","src","alt","maxWidth","maxHeight","onError","e","console","target","display","_c","$RefreshReg$"],"sources":["C:/Users/Burak/Desktop/cloud_mvp/frontend/src/components/SecureFileViewer.jsx"],"sourcesContent":["// SecureFileViewer.jsx\r\nimport React, { useState, useEffect } from 'react';\r\nimport SecureViewer from './SecureViewer';\r\nimport { useParams } from 'react-router-dom';\r\n\r\nconst SecureFileViewer = () => {\r\n    const [fileData, setFileData] = useState(null);\r\n    const [loading, setLoading] = useState(true);\r\n    const [error, setError] = useState(null);\r\n    const { token } = useParams();\r\n\r\n    useEffect(() => {\r\n        const fetchFileData = async () => {\r\n            if (!token) {\r\n                setError(\"Geçersiz veya eksik token.\");\r\n                setLoading(false);\r\n                return;\r\n            }\r\n            try {\r\n                // API endpoint'ini güncelle\r\n                const response = await fetch(`http://localhost:8001/api/share/${token}/`);\r\n\r\n                /* if (response.headers.get('X-Security-Breach') === 'CAMERA_DETECTED') {\r\n                    throw new Error('Kamera Güvenlik İhlali Tespit Edildi ve Engellendi.');\r\n                }\r\n                */\r\n\r\n                if (!response.ok) {\r\n                    // Eğer backend 403 döndürdüyse JSON veya HTML olabilir\r\n                    const contentType = response.headers.get(\"content-type\");\r\n                    if (contentType && contentType.indexOf(\"application/json\") !== -1) {\r\n                        const errorData = await response.json();\r\n                        throw new Error(errorData.error || 'Erişim hatası');\r\n                    } else {\r\n                        throw new Error('Dosyaya erişilemiyor (Süre dolmuş veya güvenlik engeli).');\r\n                    }\r\n                }\r\n\r\n                const data = await response.json();\r\n                setFileData(data);\r\n            } catch (err) {\r\n                setError(err.message);\r\n            } finally {\r\n                setLoading(false);\r\n            }\r\n        };\r\n\r\n        fetchFileData();\r\n    }, [token]);\r\n\r\n    if (loading) {\r\n        return (\r\n            <div style={{\r\n                padding: '50px',\r\n                textAlign: 'center',\r\n                background: '#1a1a1a',\r\n                color: 'white',\r\n                borderRadius: '8px'\r\n            }}>\r\n                <div>Dosya yükleniyor...</div>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    if (error) {\r\n        return (\r\n            <div style={{\r\n                padding: '50px',\r\n                textAlign: 'center',\r\n                background: '#ff4444',\r\n                color: 'white',\r\n                borderRadius: '8px'\r\n            }}>\r\n                <h3>Hata</h3>\r\n                <p>{error}</p>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    if (!fileData) {\r\n        return (\r\n            <div style={{\r\n                padding: '50px',\r\n                textAlign: 'center',\r\n                background: '#ffaa00',\r\n                color: 'white',\r\n                borderRadius: '8px'\r\n            }}>\r\n                <p>Dosya bulunamadı</p>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    // Eski SingleViewMedia component'ini kullanmak için:\r\n    // return (\r\n    //     <SingleViewMedia\r\n    //         secureMediaUrl={fileData.secure_media_url}\r\n    //         userEmail={fileData.user_email}\r\n    //         onConsumed={() => console.log('Content consumed')}\r\n    //     />\r\n    // );\r\n\r\n    // Yeni SecureViewer component'ini kullanmak için:\r\n    return (\r\n        <SecureViewer\r\n            file={{\r\n                one_time_view: fileData.one_time_view,\r\n                file_name: fileData.file_name,\r\n                secure_media_url: fileData.secure_media_url\r\n            }}\r\n            user={{\r\n                email: fileData.user_email,\r\n                username: fileData.user_email?.split('@')[0] || 'Kullanıcı'\r\n            }}\r\n        >\r\n            <div style={{ textAlign: 'center', padding: '20px' }}>\r\n                <img\r\n                    src={fileData.secure_media_url}\r\n                    alt={fileData.file_name}\r\n                    style={{\r\n                        maxWidth: '100%',\r\n                        maxHeight: '80vh',\r\n                        borderRadius: '8px'\r\n                    }}\r\n                    onError={(e) => {\r\n                        console.error('Resim yüklenemedi');\r\n                        e.target.style.display = 'none';\r\n                    }}\r\n                />\r\n            </div>\r\n        </SecureViewer>\r\n    );\r\n};\r\n\r\nexport default SecureFileViewer;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}