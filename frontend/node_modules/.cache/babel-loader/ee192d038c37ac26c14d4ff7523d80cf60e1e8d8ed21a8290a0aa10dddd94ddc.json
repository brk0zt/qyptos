{"ast":null,"code":"import axios from 'axios';\nconst API_BASE_URL = 'http://localhost:8001/api';\nconst api = axios.create({\n  baseURL: API_BASE_URL\n});\napi.interceptors.request.use(config => {\n  const token = localStorage.getItem('token');\n  if (token) {\n    config.headers.Authorization = `Bearer ${token}`;\n  }\n  return config;\n}, error => {\n  return Promise.reject(error);\n});\n\n// Grup API'leri - BUNLARIN TAMAMI groupAPI OBJESƒ∞ ƒ∞√áƒ∞NDE OLMALI\nexport const groupAPI = {\n  getGroups: () => api.get('/groups/'),\n  createGroup: name => api.post('/groups/create/', {\n    name,\n    members: [{\n      \"email\": \"\"\n    }]\n  }),\n  joinGroup: groupId => api.post(`/groups/${groupId}/join/`),\n  leaveGroup: groupId => api.post(`/groups/${groupId}/leave/`),\n  getGroupFiles: groupId => api.get(`/groups/${groupId}/files/`),\n  checkGroupAuth: groupId => api.get(`/groups/${groupId}/check-auth/`),\n  sendInvites: (groupId, emails) => {\n    return api.post(`/groups/${groupId}/invite/`, {\n      emails\n    });\n  },\n  joinByInviteCode: inviteCode => {\n    return api.post('/groups/join-by-code/', {\n      invite_code: inviteCode\n    });\n  },\n  getGroupInvitations: groupId => {\n    return api.get(`/groups/${groupId}/invitations/`);\n  }\n};\n\n// Dosya API'leri\nexport const fileAPI = {\n  uploadFile: (groupId, formData) => {\n    if (!groupId) {\n      return Promise.reject(new Error('Group ID tanƒ±mlƒ± deƒüil'));\n    }\n    return api.post(`/groups/${groupId}/upload/`, formData, {\n      headers: {\n        'Content-Type': 'multipart/form-data'\n      }\n    });\n  },\n  downloadFile: fileId => api.get(`/files/${fileId}/download/`, {\n    responseType: 'blob'\n  }),\n  getFileDetail: fileId => api.get(`/files/${fileId}/`),\n  getFileComments: fileId => api.get(`/files/${fileId}/comments/`),\n  addComment: (fileId, text) => api.post(`/files/${fileId}/comment/`, {\n    text\n  }),\n  getFileReport: fileId => api.get(`/files/${fileId}/report/`)\n};\n\n// Auth API'leri\nexport const authAPI = {\n  login: (email, password) => api.post('/auth/login/', {\n    email,\n    password\n  }),\n  checkAuth: () => api.get('/users/me/'),\n  refreshToken: () => api.post('/auth/token/refresh/', {\n    refresh: localStorage.getItem('refresh_token')\n  })\n};\n// api.js - interceptor'ƒ± tamamen yenileyin\nlet isRefreshing = false;\nlet failedQueue = [];\nconst processQueue = (error, token = null) => {\n  failedQueue.forEach(prom => {\n    if (error) {\n      prom.reject(error);\n    } else {\n      prom.resolve(token);\n    }\n  });\n  failedQueue = [];\n};\n\n/* api.interceptors.response.use(\r\n    (response) => response,\r\n    async (error) => {\r\n        const originalRequest = error.config;\r\n\r\n        // Eƒüer 401 hatasƒ± deƒüilse veya zaten retry yapƒ±ldƒ±ysa\r\n        if (error.response?.status !== 401 || originalRequest._retry) {\r\n            return Promise.reject(error);\r\n        }\r\n\r\n        // Eƒüer zaten refresh yapƒ±lƒ±yorsa, request'i kuyruƒüa al\r\n        if (isRefreshing) {\r\n            return new Promise((resolve, reject) => {\r\n                failedQueue.push({ resolve, reject });\r\n            }).then(token => {\r\n                originalRequest.headers.Authorization = `Bearer ${token}`;\r\n                return api(originalRequest);\r\n            }).catch(err => {\r\n                return Promise.reject(err);\r\n            });\r\n        }\r\n\r\n        originalRequest._retry = true;\r\n        isRefreshing = true;\r\n\r\n        try {\r\n            const refreshToken = localStorage.getItem('refresh_token');\r\n            if (!refreshToken) {\r\n                throw new Error('No refresh token available');\r\n            }\r\n\r\n            console.log('üîÑ Token refresh ediliyor...');\r\n            const response = await api.post('/auth/token/refresh/', {\r\n                refresh: refreshToken\r\n            });\r\n\r\n            const newToken = response.data.access;\r\n            localStorage.setItem('access_token', newToken);\r\n\r\n            console.log('‚úÖ Yeni token alƒ±ndƒ±:', newToken);\r\n\r\n            // T√ºm kuyruktaki request'leri i≈üle\r\n            processQueue(null, newToken);\r\n            isRefreshing = false;\r\n\r\n            // Orijinal request'i yeni token ile tekrarla\r\n            originalRequest.headers.Authorization = `Bearer ${newToken}`;\r\n            return api(originalRequest);\r\n\r\n        } catch (refreshError) {\r\n            console.error('‚ùå Token refresh failed:', refreshError);\r\n\r\n            // Kuyruktaki t√ºm request'leri ba≈üarƒ±sƒ±z olarak i≈üaretle\r\n            processQueue(refreshError, null);\r\n            isRefreshing = false;\r\n\r\n            // Token'larƒ± temizle ve login sayfasƒ±na y√∂nlendir\r\n            localStorage.removeItem('access_token');\r\n            localStorage.removeItem('refresh_token');\r\n            localStorage.removeItem('user');\r\n\r\n            // Sadece bir kere y√∂nlendir\r\n            if (!window.location.pathname.includes('/login')) {\r\n                window.location.href = '/login';\r\n            }\r\n\r\n            return Promise.reject(refreshError);\r\n        }\r\n    }\r\n);\r\n*/\nexport default api;","map":{"version":3,"names":["axios","API_BASE_URL","api","create","baseURL","interceptors","request","use","config","token","localStorage","getItem","headers","Authorization","error","Promise","reject","groupAPI","getGroups","get","createGroup","name","post","members","joinGroup","groupId","leaveGroup","getGroupFiles","checkGroupAuth","sendInvites","emails","joinByInviteCode","inviteCode","invite_code","getGroupInvitations","fileAPI","uploadFile","formData","Error","downloadFile","fileId","responseType","getFileDetail","getFileComments","addComment","text","getFileReport","authAPI","login","email","password","checkAuth","refreshToken","refresh","isRefreshing","failedQueue","processQueue","forEach","prom","resolve"],"sources":["C:/Users/Burak/Desktop/cloud_mvp/frontend/src/utils/api.js"],"sourcesContent":["import axios from 'axios';\r\n\r\nconst API_BASE_URL = 'http://localhost:8001/api';\r\n\r\nconst api = axios.create({\r\n    baseURL: API_BASE_URL,\r\n});\r\n\r\napi.interceptors.request.use(\r\n    (config) => {\r\n        const token = localStorage.getItem('token');\r\n        if (token) {\r\n            config.headers.Authorization = `Bearer ${token}`;\r\n        }\r\n        return config;\r\n    },\r\n    (error) => {\r\n        return Promise.reject(error);\r\n    }\r\n);\r\n\r\n// Grup API'leri - BUNLARIN TAMAMI groupAPI OBJESƒ∞ ƒ∞√áƒ∞NDE OLMALI\r\nexport const groupAPI = {\r\n    getGroups: () => api.get('/groups/'),\r\n    createGroup: (name) => api.post('/groups/create/', { name, members: [{ \"email\": \"\" }] }),\r\n    joinGroup: (groupId) => api.post(`/groups/${groupId}/join/`),\r\n    leaveGroup: (groupId) => api.post(`/groups/${groupId}/leave/`),\r\n    getGroupFiles: (groupId) => api.get(`/groups/${groupId}/files/`),\r\n    checkGroupAuth: (groupId) => api.get(`/groups/${groupId}/check-auth/`),\r\n\r\n    sendInvites: (groupId, emails) => {\r\n        return api.post(`/groups/${groupId}/invite/`, { emails });\r\n    },\r\n\r\n    joinByInviteCode: (inviteCode) => {\r\n        return api.post('/groups/join-by-code/', { invite_code: inviteCode });\r\n    },\r\n\r\n    getGroupInvitations: (groupId) => {\r\n        return api.get(`/groups/${groupId}/invitations/`);\r\n    }\r\n};\r\n\r\n// Dosya API'leri\r\nexport const fileAPI = {\r\n    uploadFile: (groupId, formData) => {\r\n        if (!groupId) {\r\n            return Promise.reject(new Error('Group ID tanƒ±mlƒ± deƒüil'));\r\n        }\r\n        return api.post(`/groups/${groupId}/upload/`, formData, {\r\n            headers: { 'Content-Type': 'multipart/form-data' }\r\n        });\r\n    },\r\n    downloadFile: (fileId) => api.get(`/files/${fileId}/download/`, {\r\n        responseType: 'blob'\r\n    }),\r\n    getFileDetail: (fileId) => api.get(`/files/${fileId}/`),\r\n    getFileComments: (fileId) => api.get(`/files/${fileId}/comments/`),\r\n    addComment: (fileId, text) => api.post(`/files/${fileId}/comment/`, { text }),\r\n    getFileReport: (fileId) => api.get(`/files/${fileId}/report/`),\r\n};\r\n\r\n// Auth API'leri\r\nexport const authAPI = {\r\n    login: (email, password) =>\r\n        api.post('/auth/login/', { email, password }),\r\n\r\n    checkAuth: () =>\r\n        api.get('/users/me/'),\r\n\r\n    refreshToken: () =>\r\n        api.post('/auth/token/refresh/', {\r\n            refresh: localStorage.getItem('refresh_token')\r\n        }),\r\n};\r\n// api.js - interceptor'ƒ± tamamen yenileyin\r\nlet isRefreshing = false;\r\nlet failedQueue = [];\r\n\r\nconst processQueue = (error, token = null) => {\r\n    failedQueue.forEach(prom => {\r\n        if (error) {\r\n            prom.reject(error);\r\n        } else {\r\n            prom.resolve(token);\r\n        }\r\n    });\r\n    failedQueue = [];\r\n};\r\n\r\n/* api.interceptors.response.use(\r\n    (response) => response,\r\n    async (error) => {\r\n        const originalRequest = error.config;\r\n\r\n        // Eƒüer 401 hatasƒ± deƒüilse veya zaten retry yapƒ±ldƒ±ysa\r\n        if (error.response?.status !== 401 || originalRequest._retry) {\r\n            return Promise.reject(error);\r\n        }\r\n\r\n        // Eƒüer zaten refresh yapƒ±lƒ±yorsa, request'i kuyruƒüa al\r\n        if (isRefreshing) {\r\n            return new Promise((resolve, reject) => {\r\n                failedQueue.push({ resolve, reject });\r\n            }).then(token => {\r\n                originalRequest.headers.Authorization = `Bearer ${token}`;\r\n                return api(originalRequest);\r\n            }).catch(err => {\r\n                return Promise.reject(err);\r\n            });\r\n        }\r\n\r\n        originalRequest._retry = true;\r\n        isRefreshing = true;\r\n\r\n        try {\r\n            const refreshToken = localStorage.getItem('refresh_token');\r\n            if (!refreshToken) {\r\n                throw new Error('No refresh token available');\r\n            }\r\n\r\n            console.log('üîÑ Token refresh ediliyor...');\r\n            const response = await api.post('/auth/token/refresh/', {\r\n                refresh: refreshToken\r\n            });\r\n\r\n            const newToken = response.data.access;\r\n            localStorage.setItem('access_token', newToken);\r\n\r\n            console.log('‚úÖ Yeni token alƒ±ndƒ±:', newToken);\r\n\r\n            // T√ºm kuyruktaki request'leri i≈üle\r\n            processQueue(null, newToken);\r\n            isRefreshing = false;\r\n\r\n            // Orijinal request'i yeni token ile tekrarla\r\n            originalRequest.headers.Authorization = `Bearer ${newToken}`;\r\n            return api(originalRequest);\r\n\r\n        } catch (refreshError) {\r\n            console.error('‚ùå Token refresh failed:', refreshError);\r\n\r\n            // Kuyruktaki t√ºm request'leri ba≈üarƒ±sƒ±z olarak i≈üaretle\r\n            processQueue(refreshError, null);\r\n            isRefreshing = false;\r\n\r\n            // Token'larƒ± temizle ve login sayfasƒ±na y√∂nlendir\r\n            localStorage.removeItem('access_token');\r\n            localStorage.removeItem('refresh_token');\r\n            localStorage.removeItem('user');\r\n\r\n            // Sadece bir kere y√∂nlendir\r\n            if (!window.location.pathname.includes('/login')) {\r\n                window.location.href = '/login';\r\n            }\r\n\r\n            return Promise.reject(refreshError);\r\n        }\r\n    }\r\n);\r\n*/\r\nexport default api;\r\n"],"mappings":"AAAA,OAAOA,KAAK,MAAM,OAAO;AAEzB,MAAMC,YAAY,GAAG,2BAA2B;AAEhD,MAAMC,GAAG,GAAGF,KAAK,CAACG,MAAM,CAAC;EACrBC,OAAO,EAAEH;AACb,CAAC,CAAC;AAEFC,GAAG,CAACG,YAAY,CAACC,OAAO,CAACC,GAAG,CACvBC,MAAM,IAAK;EACR,MAAMC,KAAK,GAAGC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC;EAC3C,IAAIF,KAAK,EAAE;IACPD,MAAM,CAACI,OAAO,CAACC,aAAa,GAAG,UAAUJ,KAAK,EAAE;EACpD;EACA,OAAOD,MAAM;AACjB,CAAC,EACAM,KAAK,IAAK;EACP,OAAOC,OAAO,CAACC,MAAM,CAACF,KAAK,CAAC;AAChC,CACJ,CAAC;;AAED;AACA,OAAO,MAAMG,QAAQ,GAAG;EACpBC,SAAS,EAAEA,CAAA,KAAMhB,GAAG,CAACiB,GAAG,CAAC,UAAU,CAAC;EACpCC,WAAW,EAAGC,IAAI,IAAKnB,GAAG,CAACoB,IAAI,CAAC,iBAAiB,EAAE;IAAED,IAAI;IAAEE,OAAO,EAAE,CAAC;MAAE,OAAO,EAAE;IAAG,CAAC;EAAE,CAAC,CAAC;EACxFC,SAAS,EAAGC,OAAO,IAAKvB,GAAG,CAACoB,IAAI,CAAC,WAAWG,OAAO,QAAQ,CAAC;EAC5DC,UAAU,EAAGD,OAAO,IAAKvB,GAAG,CAACoB,IAAI,CAAC,WAAWG,OAAO,SAAS,CAAC;EAC9DE,aAAa,EAAGF,OAAO,IAAKvB,GAAG,CAACiB,GAAG,CAAC,WAAWM,OAAO,SAAS,CAAC;EAChEG,cAAc,EAAGH,OAAO,IAAKvB,GAAG,CAACiB,GAAG,CAAC,WAAWM,OAAO,cAAc,CAAC;EAEtEI,WAAW,EAAEA,CAACJ,OAAO,EAAEK,MAAM,KAAK;IAC9B,OAAO5B,GAAG,CAACoB,IAAI,CAAC,WAAWG,OAAO,UAAU,EAAE;MAAEK;IAAO,CAAC,CAAC;EAC7D,CAAC;EAEDC,gBAAgB,EAAGC,UAAU,IAAK;IAC9B,OAAO9B,GAAG,CAACoB,IAAI,CAAC,uBAAuB,EAAE;MAAEW,WAAW,EAAED;IAAW,CAAC,CAAC;EACzE,CAAC;EAEDE,mBAAmB,EAAGT,OAAO,IAAK;IAC9B,OAAOvB,GAAG,CAACiB,GAAG,CAAC,WAAWM,OAAO,eAAe,CAAC;EACrD;AACJ,CAAC;;AAED;AACA,OAAO,MAAMU,OAAO,GAAG;EACnBC,UAAU,EAAEA,CAACX,OAAO,EAAEY,QAAQ,KAAK;IAC/B,IAAI,CAACZ,OAAO,EAAE;MACV,OAAOV,OAAO,CAACC,MAAM,CAAC,IAAIsB,KAAK,CAAC,wBAAwB,CAAC,CAAC;IAC9D;IACA,OAAOpC,GAAG,CAACoB,IAAI,CAAC,WAAWG,OAAO,UAAU,EAAEY,QAAQ,EAAE;MACpDzB,OAAO,EAAE;QAAE,cAAc,EAAE;MAAsB;IACrD,CAAC,CAAC;EACN,CAAC;EACD2B,YAAY,EAAGC,MAAM,IAAKtC,GAAG,CAACiB,GAAG,CAAC,UAAUqB,MAAM,YAAY,EAAE;IAC5DC,YAAY,EAAE;EAClB,CAAC,CAAC;EACFC,aAAa,EAAGF,MAAM,IAAKtC,GAAG,CAACiB,GAAG,CAAC,UAAUqB,MAAM,GAAG,CAAC;EACvDG,eAAe,EAAGH,MAAM,IAAKtC,GAAG,CAACiB,GAAG,CAAC,UAAUqB,MAAM,YAAY,CAAC;EAClEI,UAAU,EAAEA,CAACJ,MAAM,EAAEK,IAAI,KAAK3C,GAAG,CAACoB,IAAI,CAAC,UAAUkB,MAAM,WAAW,EAAE;IAAEK;EAAK,CAAC,CAAC;EAC7EC,aAAa,EAAGN,MAAM,IAAKtC,GAAG,CAACiB,GAAG,CAAC,UAAUqB,MAAM,UAAU;AACjE,CAAC;;AAED;AACA,OAAO,MAAMO,OAAO,GAAG;EACnBC,KAAK,EAAEA,CAACC,KAAK,EAAEC,QAAQ,KACnBhD,GAAG,CAACoB,IAAI,CAAC,cAAc,EAAE;IAAE2B,KAAK;IAAEC;EAAS,CAAC,CAAC;EAEjDC,SAAS,EAAEA,CAAA,KACPjD,GAAG,CAACiB,GAAG,CAAC,YAAY,CAAC;EAEzBiC,YAAY,EAAEA,CAAA,KACVlD,GAAG,CAACoB,IAAI,CAAC,sBAAsB,EAAE;IAC7B+B,OAAO,EAAE3C,YAAY,CAACC,OAAO,CAAC,eAAe;EACjD,CAAC;AACT,CAAC;AACD;AACA,IAAI2C,YAAY,GAAG,KAAK;AACxB,IAAIC,WAAW,GAAG,EAAE;AAEpB,MAAMC,YAAY,GAAGA,CAAC1C,KAAK,EAAEL,KAAK,GAAG,IAAI,KAAK;EAC1C8C,WAAW,CAACE,OAAO,CAACC,IAAI,IAAI;IACxB,IAAI5C,KAAK,EAAE;MACP4C,IAAI,CAAC1C,MAAM,CAACF,KAAK,CAAC;IACtB,CAAC,MAAM;MACH4C,IAAI,CAACC,OAAO,CAAClD,KAAK,CAAC;IACvB;EACJ,CAAC,CAAC;EACF8C,WAAW,GAAG,EAAE;AACpB,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAerD,GAAG","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}