{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Burak\\\\Desktop\\\\cloud_mvp\\\\frontend\\\\src\\\\components\\\\SecureFileViewer.jsx\",\n  _s = $RefreshSig$();\n// SecureFileViewer.jsx\nimport React, { useState, useEffect } from 'react';\nimport SingleViewMedia from './SingleViewMedia'; // Eski component\nimport SecureViewer from './SecureViewer'; // Yeni component\nimport { useParams } from 'react-router-dom';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst SecureFileViewer = () => {\n  _s();\n  var _fileData$user_email;\n  const [fileData, setFileData] = useState(null);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(null);\n  const {\n    token\n  } = useParams();\n  useEffect(() => {\n    const fetchFileData = async () => {\n      if (!token) {\n        setError(\"Geçersiz veya eksik token.\");\n        setLoading(false);\n        return;\n      }\n      try {\n        // API endpoint'ini güncelle\n        const response = await fetch(`http://localhost:8001/api/share/${token}/`);\n        if (response.headers.get('X-Security-Breach') === 'CAMERA_DETECTED') {\n          throw new Error('Kamera Güvenlik İhlali Tespit Edildi ve Engellendi.');\n        }\n        if (!response.ok) {\n          const errorData = await response.json();\n          throw new Error(errorData.error || 'Dosya yüklenirken hata oluştu');\n        }\n        const data = await response.json();\n        setFileData(data);\n      } catch (err) {\n        setError(err.message);\n      } finally {\n        setLoading(false);\n      }\n    };\n    fetchFileData();\n  }, [token]);\n  if (loading) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        padding: '50px',\n        textAlign: 'center',\n        background: '#1a1a1a',\n        color: 'white',\n        borderRadius: '8px'\n      },\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        children: \"Dosya y\\xFCkleniyor...\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 54,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 47,\n      columnNumber: 13\n    }, this);\n  }\n  if (error) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        padding: '50px',\n        textAlign: 'center',\n        background: '#ff4444',\n        color: 'white',\n        borderRadius: '8px'\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n        children: \"Hata\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 68,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        children: error\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 69,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 61,\n      columnNumber: 13\n    }, this);\n  }\n  if (!fileData) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        padding: '50px',\n        textAlign: 'center',\n        background: '#ffaa00',\n        color: 'white',\n        borderRadius: '8px'\n      },\n      children: /*#__PURE__*/_jsxDEV(\"p\", {\n        children: \"Dosya bulunamad\\u0131\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 83,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 76,\n      columnNumber: 13\n    }, this);\n  }\n\n  // Eski SingleViewMedia component'ini kullanmak için:\n  // return (\n  //     <SingleViewMedia\n  //         secureMediaUrl={fileData.secure_media_url}\n  //         userEmail={fileData.user_email}\n  //         onConsumed={() => console.log('Content consumed')}\n  //     />\n  // );\n\n  // Yeni SecureViewer component'ini kullanmak için:\n  return /*#__PURE__*/_jsxDEV(SecureViewer, {\n    file: {\n      one_time_view: fileData.one_time_view,\n      file_name: fileData.file_name,\n      secure_media_url: fileData.secure_media_url\n    },\n    user: {\n      email: fileData.user_email,\n      username: ((_fileData$user_email = fileData.user_email) === null || _fileData$user_email === void 0 ? void 0 : _fileData$user_email.split('@')[0]) || 'Kullanıcı'\n    },\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        textAlign: 'center',\n        padding: '20px'\n      },\n      children: /*#__PURE__*/_jsxDEV(\"img\", {\n        src: fileData.secure_media_url,\n        alt: fileData.file_name,\n        style: {\n          maxWidth: '100%',\n          maxHeight: '80vh',\n          borderRadius: '8px'\n        },\n        onError: e => {\n          console.error('Resim yüklenemedi');\n          e.target.style.display = 'none';\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 111,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 110,\n      columnNumber: 13\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 99,\n    columnNumber: 9\n  }, this);\n};\n_s(SecureFileViewer, \"YpQ5AdyCzHNIY3Oh+1+l0uiOylQ=\", false, function () {\n  return [useParams];\n});\n_c = SecureFileViewer;\nexport default SecureFileViewer;\nvar _c;\n$RefreshReg$(_c, \"SecureFileViewer\");","map":{"version":3,"names":["React","useState","useEffect","SingleViewMedia","SecureViewer","useParams","jsxDEV","_jsxDEV","SecureFileViewer","_s","_fileData$user_email","fileData","setFileData","loading","setLoading","error","setError","token","fetchFileData","response","fetch","headers","get","Error","ok","errorData","json","data","err","message","style","padding","textAlign","background","color","borderRadius","children","fileName","_jsxFileName","lineNumber","columnNumber","file","one_time_view","file_name","secure_media_url","user","email","user_email","username","split","src","alt","maxWidth","maxHeight","onError","e","console","target","display","_c","$RefreshReg$"],"sources":["C:/Users/Burak/Desktop/cloud_mvp/frontend/src/components/SecureFileViewer.jsx"],"sourcesContent":["// SecureFileViewer.jsx\r\nimport React, { useState, useEffect } from 'react';\r\nimport SingleViewMedia from './SingleViewMedia'; // Eski component\r\nimport SecureViewer from './SecureViewer'; // Yeni component\r\nimport { useParams } from 'react-router-dom';\r\n\r\nconst SecureFileViewer = () => {\r\n    const [fileData, setFileData] = useState(null);\r\n    const [loading, setLoading] = useState(true);\r\n    const [error, setError] = useState(null);\r\n    const { token } = useParams();\r\n\r\n    useEffect(() => {\r\n        const fetchFileData = async () => {\r\n            if (!token) {\r\n                setError(\"Geçersiz veya eksik token.\");\r\n                setLoading(false);\r\n                return;\r\n            }\r\n            try {\r\n                // API endpoint'ini güncelle\r\n                const response = await fetch(`http://localhost:8001/api/share/${token}/`);\r\n\r\n                if (response.headers.get('X-Security-Breach') === 'CAMERA_DETECTED') {\r\n                    throw new Error('Kamera Güvenlik İhlali Tespit Edildi ve Engellendi.');\r\n                }\r\n\r\n                if (!response.ok) {\r\n                    const errorData = await response.json();\r\n                    throw new Error(errorData.error || 'Dosya yüklenirken hata oluştu');\r\n                }\r\n\r\n                const data = await response.json();\r\n                setFileData(data);\r\n            } catch (err) {\r\n                setError(err.message);\r\n            } finally {\r\n                setLoading(false);\r\n            }\r\n        };\r\n\r\n        fetchFileData();\r\n    }, [token]);\r\n\r\n    if (loading) {\r\n        return (\r\n            <div style={{\r\n                padding: '50px',\r\n                textAlign: 'center',\r\n                background: '#1a1a1a',\r\n                color: 'white',\r\n                borderRadius: '8px'\r\n            }}>\r\n                <div>Dosya yükleniyor...</div>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    if (error) {\r\n        return (\r\n            <div style={{\r\n                padding: '50px',\r\n                textAlign: 'center',\r\n                background: '#ff4444',\r\n                color: 'white',\r\n                borderRadius: '8px'\r\n            }}>\r\n                <h3>Hata</h3>\r\n                <p>{error}</p>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    if (!fileData) {\r\n        return (\r\n            <div style={{\r\n                padding: '50px',\r\n                textAlign: 'center',\r\n                background: '#ffaa00',\r\n                color: 'white',\r\n                borderRadius: '8px'\r\n            }}>\r\n                <p>Dosya bulunamadı</p>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    // Eski SingleViewMedia component'ini kullanmak için:\r\n    // return (\r\n    //     <SingleViewMedia\r\n    //         secureMediaUrl={fileData.secure_media_url}\r\n    //         userEmail={fileData.user_email}\r\n    //         onConsumed={() => console.log('Content consumed')}\r\n    //     />\r\n    // );\r\n\r\n    // Yeni SecureViewer component'ini kullanmak için:\r\n    return (\r\n        <SecureViewer\r\n            file={{\r\n                one_time_view: fileData.one_time_view,\r\n                file_name: fileData.file_name,\r\n                secure_media_url: fileData.secure_media_url\r\n            }}\r\n            user={{\r\n                email: fileData.user_email,\r\n                username: fileData.user_email?.split('@')[0] || 'Kullanıcı'\r\n            }}\r\n        >\r\n            <div style={{ textAlign: 'center', padding: '20px' }}>\r\n                <img\r\n                    src={fileData.secure_media_url}\r\n                    alt={fileData.file_name}\r\n                    style={{\r\n                        maxWidth: '100%',\r\n                        maxHeight: '80vh',\r\n                        borderRadius: '8px'\r\n                    }}\r\n                    onError={(e) => {\r\n                        console.error('Resim yüklenemedi');\r\n                        e.target.style.display = 'none';\r\n                    }}\r\n                />\r\n            </div>\r\n        </SecureViewer>\r\n    );\r\n};\r\n\r\nexport default SecureFileViewer;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}